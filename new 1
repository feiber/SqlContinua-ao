CREATE DATABASE CLIENTE;
USE CLIENTE;

CREATE TABLE CLIENTE(
CLIENTE_ID INTEGER(10),
CLIENTE_NOME VARCHAR(50),
CLIENTE_END VARCHAR(50),
CLIENTE_END_CIDADE CHAR(20),
ESTADO_CODIGO VARCHAR(2),
CLIENTE_END_CEP VARCHAR(8),
CLIENTE_TELEFONE VARCHAR(10),
CLIENTE_PERC_DESCONTO DECIMAL (2,0)
);

CREATE TABLE PRODUTO(
PRODUTO_CODIGO SMALLINT(6),
PRODUTO_NOME VARCHAR(40),
PRODUTO_PRECO DOUBLE(5,2),
UE_PRODUTO_COD VARCHAR(3)
);

CREATE TABLE ESTADO(
ESTADO_CODIGO VARCHAR(2),
ESTADO_NOME VARCHAR(25)
);

CREATE TABLE PEDIDO(
PEDIDO_IDENTIFICACAO INTEGER(11),
PEDIDO_TIPO INTEGER(10),
CLIENTE_ID INTEGER(10),
PEDIDO_DATA_ENTRADA DATE,
PEDIDO_VALOR_TOTAL DECIMAL(7,2),
PEDIDO_DESCONTO DECIMAL(7,2),
PEDIDO_DT_EMBARQUE DATE
);

CREATE TABLE UE_PRODUTO(
UE_PRODUTO_COD CHAR(3),
UE_PRODUTO_DESCR VARCHAR(50)
);

CREATE TABLE ITEM(
PEDIDO_IDENTIFICACAO INTEGER(11),
PRODUTO_CODIGO SMALLINT(6),
ITEM_QUANTIDADE SMALLINT(6),
ITEM_VALOR_UNITARIO DOUBLE(5,2),
ITEM_VALOR_TOTAL DOUBLE(5,2)
);

CREATE TABLE PRODUTO_CC_6A(
PRODUTO_CC_6A_NOME VARCHAR(40),
PRODUTO_CC_6A_PRECO DOUBLE(5,2)
);

CREATE TABLE UE_PRODUTO_CC_6A(
UE_PRODUTO_CC_6A_DESCR VARCHAR(50)
);

SHOW COLUMNS FROM CLIENTE;
SHOW COLUMNS FROM ESTADO;
SHOW COLUMNS FROM PRODUTO;
SHOW COLUMNS FROM PEDIDO;
SHOW COLUMNS FROM UE_PRODUTO;
SHOW COLUMNS FROM ITEM;

DROP TABLE ITEM;

ALTER TABLE CLIENTE
   ADD PRIMARY KEY (CLIENTE_ID);
ALTER TABLE ESTADO
   ADD PRIMARY KEY (ESTADO_CODIGO);
ALTER TABLE ITEM
   ADD PRIMARY KEY (PEDIDO_IDENTIFICACAO,PRODUTO_CODIGO);
ALTER TABLE PEDIDO
   ADD PRIMARY KEY (PEDIDO_IDENTIFICACAO);
ALTER TABLE PRODUTO
   ADD PRIMARY KEY (PRODUTO_CODIGO);
ALTER TABLE PEDIDO
   ADD PRIMARY KEY (PEDIDO_IDENTIFICACAO);
ALTER TABLE UE_PRODUTO
   ADD PRIMARY KEY (UE_PRODUTO_COD);
ALTER TABLE PRODUTO_CC_6A
   ADD COLUMN PRODUTO_CC_6A_CODIGO SMALLINT NOT NULL FIRST;
ALTER TABLE PRODUTO_CC_6A
   ADD PRIMARY KEY (PRODUTO_CC_6A_CODIGO);
ALTER TABLE UE_PRODUTO_CC_6A
   ADD COLUMN UE_PRODUTO_CC_6A_CODIGO CHAR(3) NOT NULL FIRST;
ALTER TABLE UE_PRODUTO_CC_6A
   ADD PRIMARY KEY (UE_PRODUTO_CC_6A_CODIGO);

ALTER TABLE PRODUTO_CC_6A
ADD COLUMN
UE_PRODUTO_CC_6A_CODIGO CHAR(3) NOT NULL AFTER PRODUTO_CC_6A_PRECO;

ALTER TABLE PRODUTO_CC_6a
ADD FOREIGN KEY (UE_PRODUTO_CC_6A_CODIGO)
REFERENCES UE_PRODUTO_cc_6A(UE_PRODUTO_CC_6A_CODIGO)
ON UPDATE CASCADE;

SELECT * FROM PRODUTO_CC_6a;

SHOW COLUMNS FROM PRODUTO_CC_6a;

CREATE UNIQUE INDEX INDICE_PRODUTO_NOME
ON PRODUTO_CC_6A (PRODUTO_CC_6A_NOME(5));

ALTER TABLE UE_PRODUTO_CC_6A 
CHANGE COLUMN UE_PRODUTO_CC_6A_CODIGO  
UE_PRODUTO_CC_6A_CODIGO CHAR(3) NOT NULL;

ALTER TABLE PRODUTO_CC_6A
ADD COLUMN UE_PRODUTO_CC_6A_CODIGO char(3) for key;

INSERT INTO UE_PRODUTO_CC_6A (UE_PRODUTO_CC_6A_CODIGO, UE_PRODUTO_CC_6A_DESCR) 
SELECT UE_PRODUTO_COD, UE_PRODUTO_DESCR  
FROM UE_PRODUTO; 

INSERT INTO PRODUTO_CC_6A (PRODUTO_CC_6A_CODIGO, UE_PRODUTO_CC_6A_CODIGO)
VALUES (112, ‘MI’);

DELETE FROM PRODUTO_CC_6A;

INSERT INTO PRODUTO_CC_6A (PRODUTO_CC_6A_NOME, PRODUTO_CC_6A_PRECO, 
PRODUTO_CC_6A_CODIGO, UE_PRODUTO_CC_6A_CODIGO) 
SELECT PRODUTO_NOME, PRODUTO_PRECO, PRODUTO_CODIGO, UE_PRODUTO_COD  
FROM PRODUTO;

UPDATE PRODUTO_CC_6A  
SET PRODUTO_CC_6A_PRECO = PRODUTO_CC_6A_PRECO *1.5 
WHERE PRODUTO_CC_6A_PRECO < 10;

UPDATE PRODUTO_CC_6A  
SET PRODUTO_CC_6A_NOME = "FEIJAO PRETO E BRANCO" 
WHERE PRODUTO_CC_6A_CODIGO = 3;

UPDATE produto_cc_6a  
SET produto_cc_6a_preco = produto_cc_6a_preco *0.6 
WHERE ue_produto_cc_6a_codigo = 5;  